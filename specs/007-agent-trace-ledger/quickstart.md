# Quickstart: Agent Trace Ledger

## Integration Guide

### 1. Ledger Entry structure

All trace entries are automatically generated by the `AgentTraceHook` during the `PostToolUse` phase. You do not need to manually call the ledger unless implementing a custom tool that bypasses the standard hook engine (which is a VIOLATION of Invariant 2).

### 2. Reading the Ledger

The ledger is stored at `.orchestration/agent_trace.jsonl`. Each line is a valid JSON object.

Example line:

```json
{
	"timestamp": "2026-02-20T01:03:37Z",
	"agentId": "agy-77",
	"intentId": "007-agent-trace-ledger",
	"mutation": { "type": "write", "target": "src/hooks/post/AgentTraceHook.ts", "hash": "e3b0c442..." },
	"vcsRevision": "main@1a2b3c"
}
```

### 3. Verification

To verify the ledger integrity:

1. Ensure every mutation results in a new line.
2. Cross-reference the `hash` with the actual file content using `sha256sum`.
3. Check that `intentId` matches an active or completed intent in `active_intents.yaml`.

## Development Tasks

- Implement `LedgerManager.ts` in `src/utils/orchestration/`.
- Implement `AgentTraceHook.ts` in `src/hooks/post/`.
- Ensure `HookEngine` registry includes the new hook.
